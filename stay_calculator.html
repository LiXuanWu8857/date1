<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é¢¨æ»¾è‰ä½å®¿é‡‘é¡è¨ˆç®—æ©Ÿ</title>
  <style>
    @font-face {
      font-family: 'UDJingXiHei';
      src: url('https://cdn.jsdelivr.net/gh/font-store/fontstore-webfont/UDJingXiHeiPE1XG30_M.ttf') format('truetype');
      font-weight: normal;
      font-style: normal;
    }
    body {
      font-family: 'UDJingXiHei', 'Noto Sans TC', 'Microsoft JhengHei', sans-serif;
      padding: 20px;
      background-color: #ffe1ea;
      margin: 0;
      line-height: 1.6;
    }
    
    /* é¢¨æ»¾è‰å“ç‰Œå€åŸŸ */
    .brand-header {
      text-align: center;
      background-color: #fff4fa;
      padding: 30px 20px;
      border-radius: 15px;
      margin-bottom: 30px;
      border: 2px solid #d72660;
      box-shadow: 0 5px 15px rgba(215, 38, 96, 0.1);
    }
    
    .brand-title {
      color: #d72660;
      font-size: 28px;
      margin-bottom: 15px;
      font-weight: bold;
    }
    
    .brand-subtitle {
      color: #d72660;
      font-size: 18px;
      margin-bottom: 20px;
    }
    
    .brand-description {
      color: #666;
      font-size: 14px;
      margin-bottom: 20px;
      line-height: 1.8;
    }
    
    .service-values {
      display: flex;
      justify-content: space-around;
      margin: 20px 0;
      flex-wrap: wrap;
    }
    
    .value-item {
      text-align: center;
      margin: 10px;
      flex: 1;
      min-width: 100px;
    }
    
    .value-chinese {
      color: #d72660;
      font-weight: bold;
      font-size: 16px;
    }
    
    .value-english {
      color: #888;
      font-size: 12px;
      font-style: italic;
    }

    /* è¨ˆç®—å™¨å€åŸŸ */
    .calculator-section {
      background-color: #fff4fa;
      padding: 25px;
      border-radius: 15px;
      border: 2px solid #d72660;
      box-shadow: 0 5px 15px rgba(215, 38, 96, 0.1);
    }
    
    h2 {
      color: #d72660;
      text-align: center;
      margin-bottom: 25px;
    }
    
    label {
      display: block;
      margin-top: 14px;
      color: #d72660;
      font-weight: bold;
    }
    
    input {
      width: 100%;
      padding: 12px;
      margin-top: 8px;
      font-size: 16px;
      border: 1.5px solid #d72660;
      border-radius: 8px;
      box-sizing: border-box;
      font-family: 'UDJingXiHei', 'Noto Sans TC', 'Microsoft JhengHei', sans-serif;
      background-color: #fff;
      transition: border-color 0.3s;
    }
    
    input:focus {
      outline: none;
      border-color: #b61a49;
      box-shadow: 0 0 5px rgba(215, 38, 96, 0.3);
    }
    
    button {
      margin-top: 20px;
      padding: 14px;
      font-size: 16px;
      background-color: #ff8fb2;
      color: #fff;
      border: none;
      border-radius: 8px;
      width: 100%;
      letter-spacing: 1px;
      transition: all 0.3s;
      font-family: 'UDJingXiHei', 'Noto Sans TC', 'Microsoft JhengHei', sans-serif;
      cursor: pointer;
      font-weight: bold;
    }
    
    button:hover {
      background-color: #d72660;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(215, 38, 96, 0.3);
    }
    
    .clear-btn {
      background-color: #f7b2d9;
      color: #d72660;
      border: none;
      margin-bottom: 15px;
      margin-top: 10px;
    }
    
    .clear-btn:hover {
      background-color: #d72660;
      color: #fff;
    }
    
    /* Modal è¨­è¨ˆ */
    .modal {
      display: none; 
      position: fixed; 
      z-index: 1000; 
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto; 
      background-color: rgba(215, 38, 96, 0.15);
    }
    
    .modal-content {
      background-color: #fff4fa;
      margin: 8% auto;
      padding: 35px;
      border: 3px solid #d72660;
      border-radius: 20px;
      width: 90%;
      max-width: 450px;
      font-family: 'UDJingXiHei', 'Noto Sans TC', 'Microsoft JhengHei', sans-serif;
      text-align: center;
      box-shadow: 0 15px 35px rgba(215, 38, 96, 0.2);
      color: #d72660;
      font-size: 18px;
      letter-spacing: 1px;
      position: relative;
    }
    
    .confirm-btn {
      margin-top: 25px;
      width: 70%;
      background-color: #d72660;
      color: #fff;
      font-size: 18px;
      border-radius: 10px;
      border: none;
      padding: 12px 0;
      font-weight: bold;
    }
    
    .confirm-btn:hover {
      background-color: #b61a49;
    }
    

    .hidden {
        display: none;
        } 

    .spacer {
        height: 20px; /* å¯ä¾éœ€æ±‚èª¿æ•´é–“è· */
    }

    .mode-toggle {
      display: flex;
      gap: 10px;
      justify-content: center;
      margin-top: 20px;
    }

    .mode-toggle button {
      flex: 1 1 0;
      min-width: 120px;
      max-width: 220px;
      width: auto;
      margin: 0;
    }

    @media (max-width: 600px) {
      .mode-toggle {
        flex-direction: column;
        align-items: stretch;
        gap: 8px;
      }
      .mode-toggle button {
        width: 100%;
        min-width: unset;
        max-width: unset;
      }
    }

  </style>
</head>
<body>
  <!-- é¢¨æ»¾è‰å“ç‰Œå€åŸŸ -->
  <div class="brand-header">
    <h1 class="brand-title">ğŸŒ¿ é¢¨æ»¾è‰å·¥ä½œå®¤</h1>
    <p class="brand-subtitle">å¯µç‰©ä½å®¿é‡‘é¡è¨ˆç®—æ©Ÿ</p>
    <p class="brand-description">
      æˆ‘å€‘æ˜¯ä¸€ç¾¤å› ç‚ºæ„›å‹•ç‰©è€Œä»¥å‹•ç‰©ç¦åˆ©ä½œç‚ºé¦–è¦å‡ºç™¼é»çš„åœ˜éšŠï¼Œ<br>
      ä»¥ä¸æ‰“ä¸ç½µä¸”ç«™åœ¨å¯µç‰©è§’åº¦å»ç†è§£ä»–å€‘çš„éœ€æ±‚ï¼Œ<br>
      é›¶ææ‡¼çš„äº’å‹•æ¨¡å¼è®“æ¯å€‹æ¯›å°å­©éƒ½æ„›ä¸Šç…§è­·çš„å“¥å“¥å§Šå§Šï¼
    </p>
    
    <div class="service-values">
      <div class="value-item">
        <div class="value-chinese">é™ªä¼´</div>
        <div class="value-english">Accompany</div>
      </div>
      <div class="value-item">
        <div class="value-chinese">å°ˆæ¥­</div>
        <div class="value-english">Professional</div>
      </div>
      <div class="value-item">
        <div class="value-chinese">è€å¿ƒ</div>
        <div class="value-english">Patience</div>
      </div>
    </div>
    
    <p style="color: #d72660; font-weight: bold; font-size: 16px; margin-top: 15px;">
      ã€Œæˆç‚ºæ¯›å­©ç¬¬äºŒä¿¡ä»»çš„äººã€
    </p>
  </div>

  <!-- æ¨¡å¼åˆ‡æ› -->
  <div class="mode-toggle">
      <button id="stayModeBtn" class="active" onclick="switchMode('stay')">ä½å®¿æ¨¡å¼</button>
      <button id="homeModeBtn" onclick="switchMode('home')">åˆ°åºœæ¨¡å¼</button>
  </div>

  <!-- ç©ºç™½é–“è· -->
    <div class="spacer"></div>

  <!-- è¨ˆç®—å™¨å€åŸŸ -->
  <div id="stayCalculator" class="calculator-section">
    <button class="clear-btn" onclick="clearAll()">ğŸ§¹ æ¸…é™¤æ‰€æœ‰æ¬„ä½</button>
    <h2> ğŸ  ä½å®¿é‡‘é¡è¨ˆç®—æ©Ÿ</h2>

    <label>ğŸ—“ï¸ é–‹å§‹æ—¥æœŸ</label>
    <input type="date" id="startDate">

    <label>ğŸ•’ é–‹å§‹æ™‚é–“ï¼ˆHH:MMï¼‰</label>
    <input type="time" id="startTime" value="15:00">

    <label>ğŸ—“ï¸ çµæŸæ—¥æœŸ</label>
    <input type="date" id="endDate">

    <label>ğŸ•’ çµæŸæ™‚é–“ï¼ˆHH:MMï¼‰</label>
    <input type="time" id="endTime" value="11:00">

    <label>ğŸ’° æ¯æ—¥é‡‘é¡ï¼ˆå…ƒï¼‰</label>
    <input type="number" id="rate" min="0" placeholder="ä¾‹å¦‚ï¼š1200">

    <label>ğŸ« æŠ˜æ‰£ï¼ˆä¾‹å¦‚ 0.8 ç‚ºå…«æŠ˜ï¼‰</label>
    <input type="number" id="discount" min="0" max="1" step="0.01" placeholder="1 æˆ– 0.8" value="1">

    <button onclick="calculate()">ğŸ§® è¨ˆç®—è²»ç”¨</button>
    <button class="clear-btn" onclick="clearAll()">ğŸ§¹ æ¸…é™¤æ‰€æœ‰æ¬„ä½</button>
  </div>

  <!-- åˆ°åºœé‡‘é¡è¨ˆç®—æ©Ÿ -->
  <div id="homeCalculator" class="calculator-section hidden">
    <button class="clear-btn" onclick="clearAll()">ğŸ§¹ æ¸…é™¤æ‰€æœ‰æ¬„ä½</button>
    <h2>ğŸ¾åˆ°åºœé‡‘é¡è¨ˆç®—æ©Ÿ</h2>

    <label>ğŸ—“ï¸ é–‹å§‹æ—¥æœŸ</label>
    <input type="date" id="homeStartDate">

    <label>â˜€ï¸ é–‹å§‹æ™‚æ®µ</label>
    <select id="homeStartPeriod" style="font-size:20px; padding:14px; border-radius:8px; border:1.5px solid #d72660; color:#d72660; font-weight:bold;">
      <option value="am">ä¸Šåˆ</option>
      <option value="noon">ä¸­åˆ</option>
      <option value="pm">ä¸‹åˆ</option>
    </select>

    <label>ğŸ—“ï¸ çµæŸæ—¥æœŸ</label>
    <input type="date" id="homeEndDate">

    <label>ğŸŒ‡ çµæŸæ™‚æ®µ</label>
    <select id="homeEndPeriod" style="font-size:20px; padding:14px; border-radius:8px; border:1.5px solid #d72660; color:#d72660; font-weight:bold;">
      <option value="am">ä¸Šåˆ</option>
      <option value="noon">ä¸­åˆ</option>
      <option value="pm">ä¸‹åˆ</option>
    </select>

    <label>â±ï¸ æ¯æ¬¡åˆ°åºœæ™‚é–“ï¼ˆåˆ†é˜ï¼‰</label>
    <select id="visitMinutes" style="font-size:20px; padding:14px; border-radius:8px; border:1.5px solid #d72660; color:#d72660; font-weight:bold;">
      <option value="30">30</option>
      <option value="60">60</option>
      <option value="120">120</option>
      <option value="180">180</option>
    </select>

    <label>ğŸ” æ¯å¤©å¹¾æ¬¡</label>
    <input type="number" id="visitsPerDay" min="1" value="1">

    <label>ğŸ’° æ¯åŠå°æ™‚é‡‘é¡ï¼ˆå…ƒï¼‰</label>
    <input type="number" id="pricePerHalfHour" min="0">

    <label>ğŸ« æŠ˜æ‰£ï¼ˆä¾‹å¦‚ 0.8 ç‚ºå…«æŠ˜ï¼‰</label>
    <input type="number" id="homeDiscount" min="0" max="1" step="0.01" placeholder="1 æˆ– 0.8" value="1">

    <button onclick="calculateHome()">ğŸ§® è¨ˆç®—è²»ç”¨</button>
    <button class="clear-btn" onclick="clearAll()">ğŸ§¹ æ¸…é™¤æ‰€æœ‰æ¬„ä½</button>
  </div>


  <!-- Modal å½ˆå‡ºè¦–çª— -->
  <div id="modal" class="modal">
    <div class="modal-content">
      <div id="modalResultText"></div>
      <button class="confirm-btn" onclick="closeModal()">ç¢ºèª</button>
    </div>
  </div>

  <script>
    // è¨­å®šé è¨­æ—¥æœŸç‚ºç•¶å‰å¹´æœˆ
    function setDefaultDates() {
      const today = new Date();
      const currentYear = today.getFullYear();
      const currentMonth = String(today.getMonth() + 1).padStart(2, '0');
      const currentDay = String(today.getDate()).padStart(2, '0');
      
      // è¨­å®šé–‹å§‹æ—¥æœŸç‚ºä»Šå¤©ï¼ˆåªé è¨­å¹´æœˆï¼Œæ—¥æœŸä¿æŒç©ºç™½è®“ç”¨æˆ¶é¸æ“‡ï¼‰
      const todayFormatted = `${currentYear}-${currentMonth}-${currentDay}`;
      document.getElementById("startDate").value = todayFormatted;
      
      // è¨­å®šçµæŸæ—¥æœŸç‚ºæ˜å¤©
      const tomorrow = new Date(today);
      tomorrow.setDate(today.getDate());
      const tomorrowYear = tomorrow.getFullYear();
      const tomorrowMonth = String(tomorrow.getMonth() + 1).padStart(2, '0');
      const tomorrowDay = String(tomorrow.getDate()).padStart(2, '0');
      const tomorrowFormatted = `${tomorrowYear}-${tomorrowMonth}-${tomorrowDay}`;
      document.getElementById("endDate").value = tomorrowFormatted;
    }

    // é é¢è¼‰å…¥æ™‚è¨­å®šé è¨­æ—¥æœŸ
    window.onload = function () {
        setDefaultDates();
        switchMode('stay'); // é è¨­ä½å®¿
    };

    function calculate() {
      const startDateStr = document.getElementById("startDate").value;
      const startTimeStr = document.getElementById("startTime").value;
      const endDateStr = document.getElementById("endDate").value;
      const endTimeStr = document.getElementById("endTime").value;
      const rate = parseFloat(document.getElementById("rate").value);
      const discount = parseFloat(document.getElementById("discount").value);

      if (!startDateStr || !endDateStr || !startTimeStr || !endTimeStr || isNaN(rate) || isNaN(discount) || rate < 0 || discount <= 0) {
        showModal("âš ï¸ è«‹å¡«å¯«æ‰€æœ‰æ¬„ä½ä¸¦è¼¸å…¥æ­£ç¢ºæ•¸å€¼");
        return;
      }

      const startDateTime = new Date(`${startDateStr}T${startTimeStr}`);
      const endDateTime = new Date(`${endDateStr}T${endTimeStr}`);

      if (endDateTime <= startDateTime) {
        showModal("âš ï¸ çµæŸæ™‚é–“å¿…é ˆæ™šæ–¼é–‹å§‹æ™‚é–“");
        return;
      }

      // å¤©æ•¸å·®è¨ˆç®—
      const msPerDay = 1000 * 60 * 60 * 24;
      let fullDays = Math.floor((endDateTime - startDateTime) / msPerDay);

      // æª¢æŸ¥æ™‚é–“å·®è·éƒ¨åˆ†
      const remainingMs = (endDateTime - startDateTime) % msPerDay;
      const hours = remainingMs / (1000 * 60 * 60);

      let timeAddition = 0;
      if (hours > 12) {
        timeAddition = 1;
      } else if (hours > 0) {
        timeAddition = 0.5;
      }

      const totalDays = fullDays + timeAddition;
      const rawTotal = totalDays * rate;
      const finalTotal = rawTotal * discount;

      showModal(
        `ğŸ¾ <b style="color:#d72660;">ä½å®¿è¨ˆç®—çµæœ</b><br><br>` +
        `ğŸ›ï¸ å…± <b>${totalDays}</b> å¤©ï¼ˆå«åŠ æˆ <b>${timeAddition}</b> å¤©ï¼‰<br><br>` +
        `ğŸ’° åŸåƒ¹ <b>${rawTotal.toLocaleString()}</b> å…ƒ<br><br>` +
        `ğŸ« æŠ˜æ‰£å¾Œç¸½é‡‘é¡ï¼š<br><b style="font-size:22px;color:#d72660">${finalTotal.toLocaleString()}</b> å…ƒ<br><br>` +
        `<small style="color:#888;">è¬è¬æ‚¨é¸æ“‡é¢¨æ»¾è‰å·¥ä½œå®¤ ğŸŒ¿</small>`
      );
    }

    function showModal(message) {
      document.getElementById('modalResultText').innerHTML = message;
      document.getElementById('modal').style.display = 'block';
      document.body.style.overflow = 'hidden';
    }
    
    function closeModal() {
      document.getElementById('modal').style.display = 'none';
      document.body.style.overflow = 'auto';
    }

    function clearAll() {
      document.getElementById("startDate").value = '';
      document.getElementById("startTime").value = '15:00';
      document.getElementById("endDate").value = '';
      document.getElementById("endTime").value = '11:00';
      document.getElementById("rate").value = '';
      document.getElementById("discount").value = '1';
      
      // æ¸…é™¤å¾Œé‡æ–°è¨­å®šé è¨­æ—¥æœŸ
      setDefaultDates();
    }

    // é»æ“Šé®ç½©é—œé–‰Modal
    document.getElementById('modal').onclick = function(event) {
      if (event.target === document.getElementById('modal')) closeModal();
    }
    
    // ESCéµé—œé–‰Modal
    window.onkeydown = function(e) {
      if (e.key === "Escape") closeModal();
    }
    // æ¨¡å¼åˆ‡æ›é‚è¼¯
function switchMode(mode) {
  const stayBtn = document.getElementById("stayModeBtn");
  const homeBtn = document.getElementById("homeModeBtn");
  const stayCalc = document.getElementById("stayCalculator");
  const homeCalc = document.getElementById("homeCalculator");

  if (mode === 'stay') {
    stayBtn.classList.add("active");
    homeBtn.classList.remove("active");
    stayCalc.classList.remove("hidden");
    homeCalc.classList.add("hidden");
  } else {
    stayBtn.classList.remove("active");
    homeBtn.classList.add("active");
    stayCalc.classList.add("hidden");
    homeCalc.classList.remove("hidden");
  }
}

// åˆ°åºœé‡‘é¡è¨ˆç®—
function calculateHome() {
  const startDateStr = document.getElementById("homeStartDate").value;
  const endDateStr = document.getElementById("homeEndDate").value;
  const startPeriod = document.getElementById("homeStartPeriod").value;
  const endPeriod = document.getElementById("homeEndPeriod").value;
  const visitMinutes = parseInt(document.getElementById("visitMinutes").value);
  const visitsPerDay = parseInt(document.getElementById("visitsPerDay").value);
  const pricePerHalfHour = parseFloat(document.getElementById("pricePerHalfHour").value);
  const discount = parseFloat(document.getElementById("homeDiscount").value);

  if (!startDateStr || !endDateStr || isNaN(visitMinutes) || isNaN(visitsPerDay) || isNaN(pricePerHalfHour) || isNaN(discount)) {
    showModal("âš ï¸ è«‹å¡«å¯«æ‰€æœ‰æ¬„ä½ä¸¦è¼¸å…¥æ­£ç¢ºæ•¸å€¼");
    return;
  }

  const startDate = new Date(startDateStr);
  const endDate = new Date(endDateStr);
  if (endDate < startDate) {
    showModal("âš ï¸ çµæŸæ—¥æœŸä¸å¯æ—©æ–¼é–‹å§‹æ—¥æœŸ");
    return;
  }

  // æ ¹æ“šæ™‚æ®µèª¿æ•´å¤©æ•¸
  let dayDiff = (endDate - startDate) / (1000 * 60 * 60 * 24);
  if (startPeriod === 'pm' && endPeriod === 'am') {
    dayDiff += 0;
  } else if (startPeriod === 'am' && endPeriod === 'pm') {
    dayDiff += 1;
  } else {
    dayDiff += 0.5;
  }

  const totalMinutes = visitMinutes * visitsPerDay * dayDiff;
  const rawTotal = (totalMinutes / 30) * pricePerHalfHour;
  const finalTotal = rawTotal * discount;

  showModal(
    `ğŸ  <b style="color:#d72660;">åˆ°åºœè¨ˆç®—çµæœ</b><br><br>` +
    `ğŸ“… å…± <b>${dayDiff}</b> å¤©ï¼Œå¹³å‡æ¯æ—¥ ${visitsPerDay} æ¬¡<br>` +
    `â±ï¸ æ¯æ¬¡ ${visitMinutes} åˆ†é˜ï¼Œå…± ${totalMinutes} åˆ†é˜<br><br>` +
    `ğŸ’° åŸåƒ¹ <b>${rawTotal.toLocaleString()}</b> å…ƒ<br><br>` +
    `ğŸ« æŠ˜æ‰£å¾Œç¸½é‡‘é¡ï¼š<br><b style="font-size:22px;color:#d72660">${finalTotal.toLocaleString()}</b> å…ƒ<br><br>` +
    `<button class="confirm-btn" onclick="shareResult('åˆ°åºœ', ${finalTotal})">ğŸ“¤ åˆ†äº«çµæœ</button><br><br>` +
    `<small style="color:#888;">è¬è¬æ‚¨é¸æ“‡é¢¨æ»¾è‰å·¥ä½œå®¤ ğŸŒ¿</small>`
  );
  }

  // åˆ†äº«åŠŸèƒ½
  function shareResult(mode, amount) {
    const message = `ğŸ¾ ${mode}æœå‹™å ±åƒ¹ï¼š${amount.toLocaleString()} å…ƒ\nï¼ä¾†è‡ªé¢¨æ»¾è‰è¨ˆç®—æ©Ÿ`;
    if (navigator.share) {
      navigator.share({
        title: "é¢¨æ»¾è‰æœå‹™å ±åƒ¹",
        text: message,
        url: window.location.href
      }).catch(err => console.warn("åˆ†äº«å–æ¶ˆ", err));
    } else {
      alert("æ‚¨çš„è£ç½®ä¸æ”¯æ´åˆ†äº«åŠŸèƒ½");
    }
   }

   window.addEventListener('DOMContentLoaded', () => {
    const today = new Date().toISOString().split('T')[0];
    document.getElementById('homeStartDate').value = today;
    document.getElementById('homeEndDate').value = today;
    });

  </script>
</body>
</html>
